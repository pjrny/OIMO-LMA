<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Likeness Monetization Agent (LMA) Dashboard</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Load React and Babel -->
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Firebase SDKs for React -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <style>
        /* Optional custom styles for better aesthetics */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #111827; /* Dark background */
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        // Global variables must be defined before the React component uses them.
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? __firebase_config : '{}';
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        // --- Start of Pasted LikenessAgentDashboard.jsx Code ---

// NOTE: Placeholder for the user's uploaded selfie (Base64 encoded JPEG/PNG). 
const MOCK_SELFIE_BASE64 = "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mNkYAAAAAYAAjCB0C8AAAAASUVORK5CYII=";
const MOCK_PET_BASE64 = "iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAQAAAC1HAwCAAAAC0lEQVR42mP8/w8AAwAB/4G9i/oAAAAASUVORK5CYII="; // Placeholder for a pet image

// Gemini API Configuration
const API_KEY = ""; // Provided by Canvas runtime
const GEMINI_FLASH = "gemini-2.5-flash-preview-05-20";
const IMAGEN_MODEL = "imagen-3.0-generate-002";
const API_BASE = "https://generativelanguage.googleapis.com/v1beta/models/";

// --- Mock Lucide Icons (assuming availability) ---
const CheckCircle = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>;
const XCircle = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="m15 9-6 6"/><path d="m9 9 6 6"/></svg>;
const Clock = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>;
const UserCheck = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><polyline points="16 11 18 13 22 9"/></svg>;
const Music = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></svg>;
const Sword = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M14.5 17.5 19 22l-1.5-1.5L14.5 17.5z"/><path d="M13.4 9.3l-2.7 2.7 3.9 3.9 2.7-2.7c.4-.4.4-1 0-1.4l-3.5-3.5c-.4-.4-1-.4-1.4 0z"/><path d="M15 8.5l-4-4-1 1 4 4 1-1z"/></svg>;
const Image = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><circle cx="9" cy="9" r="2"/><path d="m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21"/></svg>;
const ShoppingBag = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><line x1="3" x2="21" y1="6" y2="6"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>;
const Zap = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>;
const Activity = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>;
const Eye = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>;
const DollarSign = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><line x1="12" x2="12" y1="2" y2="22"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>;
const Upload = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" x2="12" y1="3" y2="15"/></svg>;
const Send = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m22 2-7 20-4-9-9-4Z"/><path d="M22 2 11 13"/></svg>;
const Shield = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10"/></svg>;
const Heart = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3.1 0.7-3.95 2.11L12 7l-.05-.41C10.6 3.7 9.26 3 7.5 3A5.5 5.5 0 0 0 2 8.5c0 2.29 1.51 4.04 3 5.5L12 22l7-8Z"/></svg>;
const Briefcase = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect width="20" height="14" x="2" y="7" rx="2" ry="2"/><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16"/></svg>;
const Link = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71"/><path d="M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71"/></svg>;
const MessageSquare = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>;
const PawPrint = (props) => <svg {...props} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="9" r="3"/><circle cx="19" cy="20" r="3"/><path d="M11 7V4c0-1.1.9-2 2-2h4c1.1 0 2 .9 2 2v3"/><path d="M14 11V8m-3 3 1.5 1.5"/></svg>;


// Mock data structure for the six required assets
const initialAssets = [
  { 
    id: 1, 
    name: "3D Gaming Asset", 
    marketplace: "Unity Asset Store", 
    icon: Sword, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: false,
    options: { genre: 'sci-fi' } // New option for gaming
  },
  { 
    id: 2, 
    name: "Stock Image Series (Product Mockup)", 
    marketplace: "Getty Images", 
    icon: Image, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: false,
    options: { productUploaded: false } // New option for stock image
  },
  { 
    id: 3, 
    name: "How-To Videos (Yoga/Pilates) ✨", // Renamed
    marketplace: "How-To Video Producer", 
    icon: Activity, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: true,
    options: { sessionType: 'yoga', pace: 'medium' } // Updated options
  },
  { 
    id: 4, 
    name: "Adult PPV Art (Tattoo + Chat Twin) ✨", 
    marketplace: "Adult Content License", 
    icon: Zap, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: true, // ENABLED GEMINI FEATURE
    options: { tattoosEnabled: false, chatTwinEnabled: false, gender: 'female' } // Re-added gender
  },
  { 
    id: 5, 
    name: "Animated Pop Star & Music/Video (2 Jobs)", 
    marketplace: "DistroKid / YouTube Music", 
    icon: Music, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: false,
    options: { playlistLinked: false, genre: 'pop' }
  },
  { 
    id: 6, 
    name: "Plush Toy Product Mockup ✨", 
    marketplace: "Shopify Marketplace", 
    icon: ShoppingBag, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: true // ENABLED GEMINI FEATURE
  },
  { 
    id: 7, 
    name: "Pet Stock Images (FREE) ✨", // New Asset
    marketplace: "Free Tier / Unsplash", 
    icon: PawPrint, 
    status: 'pending', 
    assetId: 'N/A',
    isGemini: true,
    options: { petImageUploaded: false } // Requires pet photo upload
  },
];

// Verification Status Levels
const VERIFICATION_LEVELS = [
    { level: 0, name: "Unverified", color: "text-gray-400" },
    { level: 1, name: "Selfie Upload", color: "text-red-400" },
    { level: 2, name: "Video Scan (Body/Liveness)", color: "text-orange-400" },
    { level: 3, name: "Government ID/PII", color: "text-yellow-400" },
    { level: 4, name: "Social Links/PII Dump", color: "text-green-400" },
    { level: 5, name: "Therapist Session 1", color: "text-teal-400" },
    { level: 6, name: "Twin Flame Status", color: "text-indigo-400" },
];

// Helper to define status colors and icons
const getStatusClasses = (status) => {
  switch (status) {
    case 'success':
      return { 
        bg: 'bg-green-600/20', 
        text: 'text-green-400', 
        icon: CheckCircle, 
        ring: 'ring-green-500' 
      };
    case 'in_progress':
      return { 
        bg: 'bg-yellow-600/20', 
        text: 'text-yellow-400', 
        icon: Clock, 
        ring: 'ring-yellow-500' 
      };
    case 'failed':
      return { 
        bg: 'bg-red-600/20', 
        text: 'text-red-400', 
        icon: XCircle, 
        ring: 'ring-red-500' 
      };
    case 'pending':
    default:
      return { 
        bg: 'bg-gray-600/20', 
        text: 'text-gray-400', 
        icon: Clock, 
        ring: 'ring-gray-600' 
      };
  }
};

const HeaderCard = ({ title, value, icon: Icon, colorClass, children, small = false }) => (
  <div className={`bg-gray-800 p-6 rounded-xl shadow-2xl flex flex-col justify-between transition duration-300 ring-1 ring-gray-700 hover:ring-indigo-500 h-full ${small ? 'col-span-1 md:col-span-1' : 'col-span-full'}`}>
    <div className='flex items-center justify-between'>
        <p className="text-sm font-medium text-gray-400 uppercase">{title}</p>
        <div className={`p-2 rounded-full bg-opacity-10`}>
            <Icon className={`w-5 h-5 ${colorClass}`} />
        </div>
    </div>
    <div className="mt-3">
        <h3 className={`text-4xl font-extrabold ${colorClass}`}>{value}</h3>
    </div>
    {children && <div className="mt-4">{children}</div>}
  </div>
);

const VerificationSteps = ({ currentLevel }) => (
    <div className="pt-2">
        <h4 className="text-sm font-medium text-gray-400 mb-2 uppercase">Verification Progress ({currentLevel}/{VERIFICATION_LEVELS.length - 1})</h4>
        <ul className="space-y-1 text-xs max-h-48 overflow-y-auto pr-2">
            {VERIFICATION_LEVELS.slice(1).map(v => (
                <li key={v.level} className={`flex items-center justify-between p-1 rounded-md ${v.level <= currentLevel ? 'bg-green-700/30' : 'bg-gray-700/30'}`}>
                    <span className={v.level <= currentLevel ? 'text-green-300' : 'text-gray-400'}>
                        {v.name}
                    </span>
                    {v.level <= currentLevel ? (
                        <CheckCircle className="w-4 h-4 text-green-300" />
                    ) : (
                        <Clock className="w-4 h-4 text-gray-500" />
                    )}
                </li>
            ))}
        </ul>
        <input type="file" id="likeness-upload" className="hidden" accept="image/*,video/*,.txt,.pdf" />
        <label 
            htmlFor="likeness-upload"
            className="w-full mt-3 px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg shadow-md hover:bg-indigo-700 transition duration-150 flex items-center justify-center cursor-pointer"
        >
            <Upload className="w-4 h-4 mr-2"/> Upload Files to Continue
        </label>
    </div>
);

const Modal = ({ isOpen, onClose, title, content }) => {
  if (!isOpen) return null;

  return (
    <div className="fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-70 flex items-center justify-center p-4">
      <div className="bg-gray-800 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto">
        <div className="p-6 border-b border-gray-700 flex justify-between items-center">
          <h3 className="text-xl font-bold text-white">{title}</h3>
          <button onClick={onClose} className="text-gray-400 hover:text-white transition">
            <XCircle className="w-6 h-6" />
          </button>
        </div>
        <div className="p-6">
          {content.type === 'image' && (
            <img 
              src={content.data} 
              alt="Generated Asset" 
              className="w-full h-auto rounded-lg shadow-md border border-gray-700"
            />
          )}
          {content.type === 'json' && (
            <pre className="bg-gray-900 text-green-400 p-4 rounded-lg overflow-x-auto text-sm">
              {/* Ensure we attempt to parse to pretty print, but fallback to raw text if parsing fails */}
              {(() => {
                try {
                  return JSON.stringify(JSON.parse(content.data), null, 2);
                } catch (e) {
                  return content.data;
                }
              })()}
            </pre>
          )}
           {content.type === 'prompt' && (
            <p className="bg-gray-900 text-yellow-400 italic p-4 rounded-lg text-base">
              "{content.data}"
            </p>
          )}
           {content.type === 'text' && (
            <p className="bg-gray-900 text-white p-4 rounded-lg text-base">
              {content.data}
            </p>
          )}
        </div>
      </div>
    </div>
  );
};

const AssetCard = ({ asset, onStart, onPreview, onOptionChange }) => {
  const { bg, text, icon: Icon } = getStatusClasses(asset.status);
  const isPending = asset.status === 'pending';
  const isComplete = asset.status === 'success';

  // Helper for simple toggles
  const handleToggle = (key) => {
    onOptionChange(asset.id, key, !asset.options[key]);
  };

  return (
    <div className={`p-5 rounded-xl shadow-xl border border-gray-700 ${bg} transition duration-300 hover:shadow-indigo-900/50`}>
      <div className="flex items-center justify-between">
        <div className="flex items-center space-x-3">
          <asset.icon className={`w-6 h-6 ${text}`} />
          <h4 className="text-lg font-semibold text-white">{asset.name}</h4>
        </div>
        <span className={`text-xs font-medium px-3 py-1 rounded-full border ${text} border-current capitalize`}>
          {asset.status.replace('_', ' ')}
        </span>
      </div>
      <p className="text-sm text-gray-400 mt-2">Marketplace: {asset.marketplace}</p>
      
      {asset.isGemini && (
        <p className="text-xs text-indigo-400 mt-1">Powered by Gemini AI</p>
      )}

      {/* --- Asset Options for How-To Videos (ID 3) --- */}
      {asset.id === 3 && (
        <div className='mt-3 space-y-2 text-sm pt-2 border-t border-gray-700'>
            <label className="block text-gray-400 text-xs uppercase font-medium">Session Type:</label>
            <select 
                value={asset.options.sessionType}
                onChange={(e) => onOptionChange(asset.id, 'sessionType', e.target.value)}
                className="p-2 w-full bg-gray-700 text-white rounded-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500"
            >
                <option value="yoga">Yoga Session</option>
                <option value="pilates">Pilates Session</option>
            </select>
        </div>
      )}

      {/* --- Asset Options for Adult PPV Art (ID 4) --- */}
      {asset.id === 4 && (
        <div className='mt-3 space-y-2 text-sm pt-2 border-t border-gray-700'>
            <label className="block text-gray-400 text-xs uppercase font-medium">Likeness Options (18+ Verified):</label>
            <div className="flex space-x-3 mb-2">
                <select 
                    value={asset.options.gender}
                    onChange={(e) => onOptionChange(asset.id, 'gender', e.target.value)}
                    className="p-2 flex-grow bg-gray-700 text-white rounded-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500"
                >
                    <option value="female">Female Likeness</option>
                    <option value="male">Male Likeness</option>
                </select>
            </div>
            <div className="space-y-2">
                <div className="flex items-center justify-between bg-gray-700 p-2 rounded-lg">
                    <span className="text-white">Enable Tattoos/Morph Couture</span>
                    <input 
                        type="checkbox"
                        checked={asset.options.tattoosEnabled}
                        onChange={() => handleToggle('tattoosEnabled')}
                        className="form-checkbox h-5 w-5 text-indigo-600 rounded"
                    />
                </div>
                <div className="flex items-center justify-between bg-gray-700 p-2 rounded-lg">
                    <span className="text-white">Enable Chat Twin on Adult Channel</span>
                    <input 
                        type="checkbox"
                        checked={asset.options.chatTwinEnabled}
                        onChange={() => handleToggle('chatTwinEnabled')}
                        className="form-checkbox h-5 w-5 text-indigo-600 rounded"
                    />
                </div>
            </div>
        </div>
      )}
      
      {/* --- Asset Options for Stock Image Series (ID 2) --- */}
      {asset.id === 2 && (
        <div className='mt-3 space-y-2 text-sm pt-2 border-t border-gray-700'>
            <label className="block text-gray-400 text-xs uppercase font-medium">Product Mockup:</label>
            <input type="file" id={`product-upload-${asset.id}`} className="hidden" accept="image/*" />
            <label 
                htmlFor={`product-upload-${asset.id}`}
                onClick={() => handleToggle('productUploaded')} // Mock toggle for demonstration
                className={`w-full px-4 py-2 text-sm font-medium rounded-lg shadow-md hover:scale-[1.02] transition duration-150 flex items-center justify-center cursor-pointer ${asset.options.productUploaded ? 'bg-green-600 text-white' : 'bg-gray-600 text-white hover:bg-gray-700'}`}
            >
                <Upload className="w-4 h-4 mr-2"/> {asset.options.productUploaded ? 'Product Image Uploaded' : 'Upload Product Mockup'}
            </label>
        </div>
      )}

      {/* --- Asset Options for Pet Stock Images (ID 7) --- */}
      {asset.id === 7 && (
        <div className='mt-3 space-y-2 text-sm pt-2 border-t border-gray-700'>
            <label className="block text-gray-400 text-xs uppercase font-medium">Pet Photo Source (Required):</label>
            <input type="file" id={`pet-upload-${asset.id}`} className="hidden" accept="image/*" />
            <label 
                htmlFor={`pet-upload-${asset.id}`}
                onClick={() => handleToggle('petImageUploaded')} // Mock toggle for demonstration
                className={`w-full px-4 py-2 text-sm font-medium rounded-lg shadow-md hover:scale-[1.02] transition duration-150 flex items-center justify-center cursor-pointer ${asset.options.petImageUploaded ? 'bg-green-600 text-white' : 'bg-gray-600 text-white hover:bg-gray-700'}`}
            >
                <Upload className="w-4 h-4 mr-2"/> {asset.options.petImageUploaded ? 'Pet Image Uploaded' : 'Upload Pet Photo'}
            </label>
        </div>
      )}

      {/* --- Music Job Options (ID 5) --- */}
      {asset.id === 5 && (
        <div className='mt-3 space-y-2 text-sm pt-2 border-t border-gray-700'>
            <label className="block text-gray-400 text-xs uppercase font-medium">Music Generation:</label>
            <div className="flex justify-between items-center space-x-2">
                <select 
                    value={asset.options.genre}
                    onChange={(e) => onOptionChange(asset.id, 'genre', e.target.value)}
                    className="p-2 flex-grow bg-gray-700 text-white rounded-lg border border-gray-600 focus:ring-indigo-500 focus:border-indigo-500"
                >
                    <option value="pop">Pop</option>
                    <option value="edm">EDM</option>
                    <option value="hip-hop">Hip-Hop</option>
                    <option value="latin">Latin</option>
                </select>
                <button
                    onClick={() => handleToggle('playlistLinked')}
                    className={`px-3 py-2 text-sm font-medium rounded-lg shadow-md transition duration-150 ${asset.options.playlistLinked ? 'bg-green-600 hover:bg-green-700 text-white' : 'bg-yellow-600 hover:bg-yellow-700 text-gray-900'}`}
                >
                    {asset.options.playlistLinked ? 'Playlist Linked' : 'Link Playlist'}
                </button>
            </div>
             <p className="text-xs text-gray-500 mt-1">
                Note: Music and Video jobs must be run separately after linking a playlist.
            </p>
        </div>
      )}

      <div className="mt-4 pt-4 border-t border-gray-700 flex items-center justify-between">
        <p className="text-sm font-mono text-gray-500 truncate mr-4">
          ID: {asset.assetId}
        </p>
        
        <div className="flex space-x-2">
            {isComplete && asset.assetData && (
                <button 
                    onClick={() => onPreview(asset)}
                    className="px-3 py-2 bg-indigo-500/10 text-indigo-400 text-sm font-medium rounded-lg shadow-md hover:bg-indigo-500/20 transition duration-150 transform hover:scale-[1.02] flex items-center"
                >
                    <Eye className="w-4 h-4 mr-1"/> Preview
                </button>
            )}
            {(isPending || asset.status === 'failed') && (
                <button 
                    onClick={() => onStart(asset.id)}
                    className="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg shadow-md hover:bg-indigo-700 transition duration-150 transform hover:scale-[1.02]"
                    disabled={asset.status === 'in_progress'}
                >
                    {asset.status === 'in_progress' ? 'Running...' : asset.id === 5 ? 'Run Music Job' : 'Run Job'}
                </button>
            )}
            {asset.id === 5 && asset.assetId !== 'N/A' && (
                <button 
                    onClick={() => onStart(asset.id + 0.1)} // Use decimal to signify video job for music
                    className="px-4 py-2 bg-indigo-600 text-white text-sm font-medium rounded-lg shadow-md hover:bg-indigo-700 transition duration-150 transform hover:scale-[1.02]"
                    disabled={asset.status === 'in_progress'}
                >
                    Run Video Job
                </button>
            )}
        </div>
      </div>
    </div>
  );
};

const PayoutCard = ({ userId, payoutMethod, totalEarnings, assetFolderUrl }) => (
  <div className="bg-gray-800 p-6 rounded-xl shadow-lg border border-indigo-600/50">
    <h3 className="text-xl font-bold text-white mb-4 flex items-center">
      <DollarSign className="w-5 h-5 mr-2 text-green-400" />
      Royalty & Payout Setup
    </h3>
    <div className="space-y-3">
      <div className="flex justify-between items-center text-sm">
        <span className="text-gray-400">User ID:</span>
        <code className="bg-gray-700 text-yellow-400 px-2 py-1 rounded-md truncate">{userId}</code>
      </div>
      <div className="flex justify-between items-center text-sm">
        <span className="text-gray-400">Payout Method:</span>
        <span className="text-green-400 font-medium">{payoutMethod}</span>
      </div>
      <div className="flex justify-between items-center text-sm">
        <span className="text-gray-400">Asset Folder Link:</span>
        <a href={assetFolderUrl} target="_blank" rel="noopener noreferrer" className="text-indigo-400 hover:underline flex items-center truncate max-w-[60%]">
          <Link className="w-4 h-4 mr-1"/> Odoo Asset Link
        </a>
      </div>
      <div className="flex justify-between items-center text-lg font-bold pt-3 border-t border-gray-700 mt-3">
        <span className="text-indigo-400">Total Royalty Earnings:</span>
        <span className="text-green-400">{totalEarnings}</span>
      </div>
    </div>
  </div>
);

const MatchmakingCard = ({ onRunMatch }) => {
    const { useState, useEffect } = React;
    const [status, setStatus] = useState('pending'); // pending, in_progress, matched, no_match
    const [matchName, setMatchName] = useState('N/A');
    const [matchType, setMatchType] = useState('BFF');

    const handleRunMatch = async () => {
        setStatus('in_progress');
        setMatchName('Searching...');

        // Simulate AI Therapist consultation and match logic
        await new Promise(resolve => setTimeout(resolve, 2000));
        
        const possibleMatches = ['Sophia_Bizz', 'Liam_BFF', 'Mia_Date', 'Alex_BFF'];
        const outcome = Math.random() > 0.4 ? 'matched' : 'no_match';
        const type = ['BFF', 'Date', 'Bizz'][Math.floor(Math.random() * 3)];
        
        if (outcome === 'matched') {
            setMatchName(possibleMatches[Math.floor(Math.random() * possibleMatches.length)]);
            setMatchType(type);
            setStatus('matched');
        } else {
            setMatchName('No strong match found.');
            setStatus('no_match');
        }
    };

    const StatusIcon = status === 'matched' ? Heart : status === 'no_match' ? XCircle : Clock;
    const StatusColor = status === 'matched' ? 'text-pink-400' : status === 'no_match' ? 'text-yellow-400' : 'text-gray-400';

    return (
        <div className="bg-gray-800 p-6 rounded-xl shadow-lg border border-pink-600/50">
            <h3 className="text-xl font-bold text-white mb-4 flex items-center">
                <Heart className="w-5 h-5 mr-2 text-pink-400" />
                AI Matchmaking (BFF / Bizz / Date)
            </h3>
            <p className="text-sm text-gray-400 mb-4">
                Leverages AI Therapist data to find highly compatible, verified creators.
            </p>
            
            <div className="space-y-3">
                <div className="flex justify-between items-center text-sm">
                    <span className="text-gray-400">Match Type:</span>
                    <span className={`font-semibold ${StatusColor}`}>{matchType}</span>
                </div>
                <div className="flex justify-between items-center text-lg font-bold">
                    <span className="text-indigo-400">Match Result:</span>
                    <span className={`${StatusColor} flex items-center`}>
                        <StatusIcon className={`w-5 h-5 mr-1 ${StatusColor}`} />
                        {matchName}
                    </span>
                </div>
            </div>
            
            <button 
                onClick={handleRunMatch}
                className={`w-full mt-4 px-4 py-2 text-white font-medium rounded-lg shadow-md transition duration-150 ${status === 'in_progress' ? 'bg-gray-600' : 'bg-pink-600 hover:bg-pink-700'}`}
                disabled={status === 'in_progress'}
            >
                {status === 'in_progress' ? 'Consulting Therapist AI...' : 'Run Matchmaking'}
            </button>
        </div>
    );
};

// --- Gemini API Call Functions ---
const callGeminiAPI = async ({ model, prompt, mimeType, data, config, isImageGeneration }) => {
    const url = `${API_BASE}${model}:${isImageGeneration ? 'predict' : 'generateContent'}?key=${API_KEY}`;
    
    // Build contents array for text/multimodal models (non-Imagen)
    let contents = [{ parts: [{ text: prompt }] }];
    if (data) {
        contents = [{
            role: "user",
            parts: [
                { text: prompt },
                { inlineData: { mimeType: mimeType || "image/jpeg", data: data } }
            ]
        }];
    }

    let payload = { contents };

    if (config) {
        if (isImageGeneration) {
            // Imagen model uses 'instances' and 'parameters'
            payload = { 
                instances: [{ prompt: prompt }], 
                parameters: { ...config, sampleCount: 1 } 
            };
        } else {
            // Standard generateContent model uses 'generationConfig'
            payload.generationConfig = config;
        }
    }
    
    const headers = { 'Content-Type': 'application/json' };

    for (let attempt = 0; attempt < 3; attempt++) {
        try {
            const response = await fetch(url, {
                method: 'POST',
                headers: headers,
                body: JSON.stringify(payload)
            });

            if (!response.ok) {
                // Handle non-200 responses
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const result = await response.json();
            
            if (isImageGeneration) {
                 // Imagen-3.0 response structure
                const base64Data = result.predictions?.[0]?.bytesBase64Encoded;
                if (base64Data) return base64Data;
            } else {
                // generateContent (text/multimodal) response structure
                const part = result.candidates?.[0]?.content?.parts?.[0];
                if (part?.text) return part.text;
            }

            throw new Error("API response structure was invalid or empty.");

        } catch (error) {
            console.error(`Attempt ${attempt + 1} failed:`, error);
            if (attempt === 2) throw new Error(`Failed to call Gemini API after multiple retries. ${error.message}`);
            await new Promise(resolve => setTimeout(resolve, 1000 * Math.pow(2, attempt))); // Exponential backoff
        }
    }
    throw new Error("API call failed unexpectedly.");
};

const generatePlushToyMockup = async (selfieBase64) => {
    const prompt = `Generate a photo of a cute, professionally designed, manufacturable plush toy of the person 
in the provided photo. The plush toy should be made of soft, tactile materials (minky fabric) 
and be displayed in professional e-commerce studio lighting with a clean white background. 
Make it look like a high-quality, boxed collectible.`;
    
    return callGeminiAPI({
        model: IMAGEN_MODEL,
        prompt: prompt,
        data: selfieBase64,
        config: { imageSize: "1024x1024", aspectRatio: "1:1" },
        isImageGeneration: true
    });
};

const generateYogaScript = async (selfieBase64, sessionType) => {
    const sessionName = sessionType === 'yoga' ? 'Sun Salutation Morning Flow' : 'Core Focus Pilates Routine';
    
    const prompt = `Based on the likeness in the provided photo, generate a detailed video storyboard and script 
for a 15-minute '${sessionName}'. The output must be a JSON object containing 
a sequence of 8 poses/exercises, including name, duration, and a description of the camera angle/shot type. 
The person in the visualization should look like the user in the provided photo.`;

    const schema = {
        type: "ARRAY",
        description: `A sequence of 8 moves for a beginner ${sessionType} session.`,
        items: {
            type: "OBJECT",
            properties: {
                moveName: { "type": "STRING", "description": "Name of the move (e.g., Mountain Pose or Hundred)." },
                durationSeconds: { "type": "INTEGER", "description": "Duration to hold the move in seconds (e.g., 30)." },
                videoShotDescription: { "type": "STRING", "description": "Detailed description of the animated scene and camera angle (e.g., 'Medium shot, person facing the camera, beach background.')." }
            }
        }
    };

    return callGeminiAPI({
        model: GEMINI_FLASH,
        prompt: prompt,
        data: selfieBase64,
        mimeType: "image/jpeg",
        config: { responseMimeType: "application/json", responseSchema: schema },
        isImageGeneration: false
    });
};

const generateTattooedLikenessPrompt = async (selfieBase64, tattoosEnabled, gender) => {
    const tattooDescription = tattoosEnabled ? "with highly detailed full-body blackwork tattoos" : "without any visible tattoos, in a clean artistic style";
    const figureType = gender === 'male' ? "a highly attractive male figure" : "a highly attractive female figure";
    
    const prompt = `Generate a detailed, NSFW-compliant prompt suitable for a professional image model. 
The prompt should describe the user in the provided photo, rendered as ${figureType}, 
${tattooDescription}. The scene should be cinematic and clearly marked for Pay-Per-View adult content licensing. 
Output ONLY the image generation prompt string.`;

    const generatedPrompt = await callGeminiAPI({
        model: GEMINI_FLASH,
        prompt: prompt,
        data: selfieBase64,
        mimeType: "image/jpeg",
        isImageGeneration: false
    });
    
    return generatedPrompt.trim();
};

const generatePetStockImage = async (petImageBase64) => {
    const prompt = `Generate 5 high-quality, commercial stock photos featuring the pet in the provided image. The settings should be varied: 1) Professional studio portrait, 2) Playing outdoors in golden hour, 3) Wearing a funny hat, 4) Looking curious at a modern coffee cup, 5) Sleeping peacefully. Output a single text string listing the 5 individual image prompts.`;

    const generatedPrompt = await callGeminiAPI({
        model: GEMINI_FLASH,
        prompt: prompt,
        data: petImageBase64,
        mimeType: "image/jpeg",
        isImageGeneration: false
    });
    
    return generatedPrompt.trim();
};


const App = () => {
  const { useState, useEffect } = React; // FIX: Destructure hooks from React
  const [db, setDb] = useState(null);
  const [auth, setAuth] = useState(null);
  const [userId, setUserId] = useState(null);
  const [isAuthReady, setIsAuthReady] = useState(false);
  
  const [assets, setAssets] = useState(initialAssets);
  const [verificationLevel, setVerificationLevel] = useState(3); // Start at Gov ID for mock testing
  const [totalEarnings, setTotalEarnings] = useState('$4,521.89'); 
  const [payoutMethod] = useState("Stripe Connect (ID: payout_acct_789)");
  const [assetFolderUrl] = useState("https://odoo.erp/assets/f7h8d2j"); // Mock Asset Folder URL

  const [isModalOpen, setIsModalState] = useState(false);
  const [modalContent, setModalContent] = useState({});

  const setIsModalOpen = (isOpen) => {
    setIsModalState(isOpen);
    // When closing the modal, clear content to allow new content to render cleanly.
    if (!isOpen) {
      setModalContent({});
    }
  };

  // --- Firebase Initialization and Auth ---
  useEffect(() => {
    // FIX: Use Firebase V9 compatibility API for older browser support in this single HTML file
    const firebaseConfigParsed = JSON.parse(firebaseConfig);
    
    if (!firebaseConfigParsed.apiKey) {
      console.error("Firebase config is missing. Firestore persistence disabled.");
      setIsAuthReady(true);
      return;
    }

    try {
      const app = firebase.initializeApp(firebaseConfigParsed);
      const dbInstance = firebase.firestore(app);
      const authInstance = firebase.auth(app);
      setDb(dbInstance);
      setAuth(authInstance);

      authInstance.onAuthStateChanged((user) => {
        if (user) {
          setUserId(user.uid);
        } else {
          // If no user, sign in anonymously or use custom token
          if (initialAuthToken) {
            authInstance.signInWithCustomToken(initialAuthToken)
              .then(userCredential => setUserId(userCredential.user.uid))
              .catch(error => {
                console.error("Custom token sign-in failed:", error);
                authInstance.signInAnonymously().then(userCredential => setUserId(userCredential.user.uid));
              });
          } else {
            authInstance.signInAnonymously().then(userCredential => setUserId(userCredential.user.uid));
          }
        }
        setIsAuthReady(true);
      });
    } catch (e) {
      console.error("Firebase initialization failed:", e);
      setIsAuthReady(true);
    }
  }, []);
  
  // Mock Firebase Firestore Listener (only used to satisfy mandatory requirement)
  useEffect(() => {
    if (db && userId) {
      const dataRef = db.collection('artifacts').doc(appId).collection('users').doc(userId).collection('dashboard').doc('status');
      const unsubscribe = dataRef.onSnapshot((docSnap) => {
        if (docSnap.exists) {
          const data = docSnap.data();
          if (data.earnings) {
              setTotalEarnings(data.earnings);
          }
          if (data.verificationLevel !== undefined) {
            setVerificationLevel(data.verificationLevel);
          }
        } else {
             setTotalEarnings('$4,521.89');
             setVerificationLevel(4); // Mock initial verified state
        }
      }, (error) => {
        console.error("Firestore error:", error);
      });
      return () => unsubscribe();
    }
  }, [db, userId]);

  // --- Option Change Handler for Asset Options ---
  const handleOptionChange = (id, key, value) => {
    setAssets(prevAssets => 
        prevAssets.map(a => 
            a.id === id ? { ...a, options: { ...a.options, [key]: value } } : a
        )
    );
  };
  
  // --- API Call Handler ---

  const handleStartJob = async (id) => {
    const asset = assets.find(a => a.id === Math.floor(id));
    if (!asset || asset.status === 'in_progress') return;

    // Handle music job separation
    const isVideoJob = id !== Math.floor(id);

    // Set status to in_progress
    setAssets(prevAssets => 
      prevAssets.map(a => 
        a.id === Math.floor(id) ? { ...a, status: 'in_progress', assetId: isVideoJob ? 'Generating Video...' : 'Generating...' } : a
      )
    );

    let newStatus = 'failed';
    let newAssetId = 'FAILED_JOB';
    let newAssetData = null;
    
    try {
        if (asset.id === 7) { // Pet Stock Images (New Feature)
            if (!asset.options.petImageUploaded) {
                throw new Error("Pet image must be uploaded before running job.");
            }
            const generatedPrompt = await generatePetStockImage(MOCK_PET_BASE64);
            newStatus = 'success';
            newAssetId = `PET-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
            newAssetData = { type: 'prompt', data: generatedPrompt };

        } else if (asset.id === 6) { // Plush Toy Mockup (Image Generation)
            const base64Image = await generatePlushToyMockup(MOCK_SELFIE_BASE64);
            newStatus = 'success';
            newAssetId = `IMG-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
            newAssetData = { type: 'image', data: `data:image/png;base64,${base64Image}` };

        } else if (asset.id === 3) { // How-To Videos (Structured Text Generation)
            const jsonScript = await generateYogaScript(MOCK_SELFIE_BASE64, asset.options.sessionType);
            newStatus = 'success';
            newAssetId = `JSON-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
            newAssetData = { type: 'json', data: jsonScript };

        } else if (asset.id === 4) { // Adult PPV Art Prompt Generation (Text Prompt)
            const generatedPrompt = await generateTattooedLikenessPrompt(
                MOCK_SELFIE_BASE64,
                asset.options.tattoosEnabled,
                asset.options.gender
            );
            newStatus = 'success';
            newAssetId = `PROMPT-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
            newAssetData = { type: 'prompt', data: generatedPrompt };
        
        } else if (asset.id === 5) { // Music/Video Job
            await new Promise(resolve => setTimeout(resolve, 2000));
            newStatus = 'success';
            if (isVideoJob) {
                newAssetId = `MV-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
                newAssetData = { type: 'text', data: `Music Video generated and pushed to DistroKid/YouTube Channel!` };
            } else {
                newAssetId = `TRACK-${Math.random().toString(36).substring(2, 9).toUpperCase()}`;
                newAssetData = { type: 'text', data: `Track generated in ${asset.options.genre} style.` };
            }

        } else {
            // Mock other jobs for demonstration
            await new Promise(resolve => setTimeout(resolve, 1500));
            newStatus = Math.random() > 0.1 ? 'success' : 'failed';
            newAssetId = newStatus === 'success' ? `MOCK-${id}-${Math.random().toString(36).substring(2, 9).toUpperCase()}` : 'FAILED_JOB';
        }

    } catch (error) {
        console.error(`AI Job ${asset.name} failed:`, error.message);
        newStatus = 'failed';
        newAssetId = `ERROR: ${error.message.substring(0, 20)}...`;
    }

    // Update final status and data
    setAssets(prevAssets => 
      prevAssets.map(a => {
        if (a.id === Math.floor(id)) {
          // If it was the video job, update ID 5's data
          if (isVideoJob) {
             return { ...a, status: newStatus, assetId: a.assetId + '/' + newAssetId, assetData: newAssetData };
          }
          return { ...a, status: newStatus, assetId: newAssetId, assetData: newAssetData };
        }
        return a;
      })
    );
  };
  
  const handlePreview = (asset) => {
      if (asset.assetData) {
          setModalContent({
              type: asset.assetData.type,
              data: asset.assetData.data,
          });
          setIsModalOpen(true);
      }
  };


  const totalAssets = assets.length;
  const completedAssets = assets.filter(a => a.status === 'success').length;
  const inProgressAssets = assets.filter(a => a.status === 'in_progress').length;
  const completionRate = totalAssets > 0 ? ((completedAssets / totalAssets) * 100).toFixed(0) : 0;
  
  const currentVerification = VERIFICATION_LEVELS.find(v => v.level === verificationLevel) || VERIFICATION_LEVELS[0];

  if (!isAuthReady) {
    return <div className="min-h-screen bg-gray-900 text-white flex items-center justify-center">Loading Authentication...</div>;
  }

  return (
    <div className="min-h-screen bg-gray-900 font-sans p-4 sm:p-8 relative">
      <div className="max-w-7xl mx-auto">
        <h1 className="text-4xl font-extrabold text-white mb-2">
          Likeness Monetization Agent (LMA)
        </h1>
        <p className="text-lg text-indigo-400 mb-8">
          Asset Generation and Payout Tracking Dashboard
        </p>
        
        {/* --- Header Cards (Redesigned for Verification Steps) --- */}
        <div className="grid grid-cols-1 md:grid-cols-3 gap-6 mb-10">
          
          {/* Detailed Verification Steps (Larger Card) */}
          <div className="md:col-span-2">
            <HeaderCard 
                title="Identity Verification Status" 
                value={currentVerification.name.toUpperCase()}
                icon={Shield} 
                colorClass={currentVerification.color}
                small={false}
            >
              <VerificationSteps currentLevel={verificationLevel} />
            </HeaderCard>
          </div>

          {/* Job Performance Overview (Smaller Card) */}
          <div className="md:col-span-1">
             <HeaderCard 
                title="Job Performance Overview" 
                value={`${completedAssets} / ${totalAssets}`} 
                icon={Activity} 
                colorClass="text-indigo-400"
                small={true}
            >
                <div className="pt-3 border-t border-gray-700 space-y-2">
                    <p className="flex justify-between text-sm text-gray-300">
                        <span>Jobs in Progress:</span>
                        <span className="font-semibold text-yellow-400">{inProgressAssets}</span>
                    </p>
                    <p className="flex justify-between text-sm text-gray-300">
                        <span>Completion Rate:</span>
                        <span className="font-semibold text-white">{completionRate}%</span>
                    </p>
                </div>
            </HeaderCard>
          </div>
        </div>

        {/* --- Main Content Grid --- */}
        <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
          
          {/* Asset Generation Column (2/3 width on large screen) */}
          <div className="lg:col-span-2 space-y-6">
            <h2 className="text-2xl font-semibold text-white border-b border-gray-700 pb-3">
              Multi-Modal Asset Generation Pipeline
            </h2>
            <div className="grid grid-cols-1 sm:grid-cols-2 gap-6">
              {assets.map(asset => (
                <AssetCard 
                    key={asset.id} 
                    asset={asset} 
                    onStart={handleStartJob} 
                    onPreview={handlePreview}
                    onOptionChange={handleOptionChange}
                />
              ))}
            </div>
            <div className="bg-red-900/30 text-red-300 p-4 rounded-lg text-sm mt-4">
                NOTE: Jobs 3, 4, 6, and the new **Pet Stock Images (ID 7)** are live with Gemini API features. **ID 7 will fail if you do not mock a pet image upload.**
            </div>
          </div>

          {/* User/Royalty Column (1/3 width on large screen) */}
          <div className="lg:col-span-1 space-y-6">
            <h2 className="text-2xl font-semibold text-white border-b border-gray-700 pb-3">
              Customer Data & Matching
            </h2>
            
            <div className="p-6 bg-gray-800 rounded-xl shadow-lg">
                <h4 className="text-xl font-bold text-white mb-3 flex items-center">
                    <UserCheck className="w-5 h-5 mr-2 text-yellow-400" />
                    Customer PII (Odoo Record)
                </h4>
                <p className="text-sm text-gray-400">
                    Email: <span className="text-white">customer@example.com</span>
                </p>
                <p className="text-sm text-gray-400">
                    User ID: <code className="text-yellow-400 truncate">{userId || 'N/A'}</code>
                </p>
                <div className="mt-4 pt-4 border-t border-gray-700">
                     <p className="text-sm text-gray-400 flex justify-between items-center">
                        <span className="font-medium">Likeness Folder:</span>
                        <a href={assetFolderUrl} target="_blank" rel="noopener noreferrer" className="text-indigo-400 hover:underline flex items-center truncate max-w-[60%]">
                            <Link className="w-4 h-4 mr-1"/> Odoo Asset Link
                        </a>
                    </p>
                </div>
            </div>
            
            <PayoutCard 
                userId={userId || 'N/A'} 
                payoutMethod={payoutMethod} 
                totalEarnings={totalEarnings}
                assetFolderUrl={assetFolderUrl}
            />

            <MatchmakingCard />

          </div>
        </div>
      </div>
      
      <Modal 
          isOpen={isModalOpen} 
          onClose={() => setIsModalOpen(false)} 
          title="Generated Asset Preview" 
          content={modalContent} 
      />

      {/* --- Floating Chat Bubble (Conceptual) --- */}
      <button 
        className="fixed bottom-6 right-6 p-4 bg-indigo-600 rounded-full shadow-lg text-white hover:bg-indigo-700 transition duration-300 z-40 transform hover:scale-110"
        title="Open AI Prompt Generator / Help Chat"
        onClick={() => alert("Simulating General Chat: Use this for help, general questions, or generating custom prompts for images/videos!")}
      >
        <Send className="w-6 h-6" />
      </button>

      {/* --- Floating Therapist Chat Bubble (Conceptual) --- */}
      <button 
        className="fixed bottom-6 right-20 p-4 bg-green-600 rounded-full shadow-lg text-white hover:bg-green-700 transition duration-300 z-40 transform hover:scale-110"
        title="Open AI Therapist Chat"
        onClick={() => alert("Simulating AI Therapist Chat: Use this for wellness checks, personality profiling, and initiating Bizz/BFF/Date matchmaking verification.")}
      >
        <MessageSquare className="w-6 h-6" />
      </button>

    </div>
  );
};

// --- Render the React Component (FIXED) ---
const container = document.getElementById('root');
const root = ReactDOM.createRoot(container);
root.render(<App />);
    </script>
</body>
</html>
